import{Q as V,a as h}from"./QSelect.16b3b338.js";import{A as B,ai as A,r as m,K as $,w as L,_ as T,C as d,D as b,E as l,F as u,af as c,L as v,M as w,N as ue,O as I,I as oe,H as _,ay as O,az as j,ae,B as E,aj as S}from"./index.39e089c8.js";import{C as le,Q as te,a as se}from"./ConfirmDialog.11da217d.js";import{Q as G}from"./QInput.de104804.js";import{u as ne}from"./programs.store.189ebfe6.js";import{a as D,Q as F}from"./QCard.ae9a5f35.js";import{Q as U}from"./QCardActions.fa69a4e2.js";import{Q as z}from"./QDialog.43234b2d.js";import{u as M}from"./categories.store.138296d4.js";import{a as ie}from"./socket.store.0f823f3a.js";import{L as re}from"./LoadingComponent.20ac781b.js";import"./use-timeout.8f2f2ab4.js";import"./QItem.b3c54dac.js";import"./use-dark.05cf27ed.js";import"./QSeparator.a6210892.js";import"./QList.51d46cd2.js";import"./message.store.d584a04e.js";import"./use-quasar.dac27476.js";const de=B({name:"ProgramEdit",props:{isShow:{type:Boolean,default:!1},task:{type:Object}},components:{},setup(e,o){const r=[{label:"\u043B\u0435\u0432\u044B\u0439",value:0},{label:"\u043F\u0440\u0430\u0432\u044B\u0439",value:1}],f=A(()=>e.isShow),t=m(),g=M(),{categoryNames:a}=$(g),i=m(""),p=m();return L(()=>f.value,C=>{if(C)if(e.task)t.value={...e.task},i.value=t.value.category?t.value.category:"",p.value=r.find(y=>y.value===t.value.ball);else{const y=g.getDefaultCategory();i.value=y?y.name:"\u0431\u0435\u0437 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",p.value=r[0],t.value={name:"\u043D\u0435 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043E",description:"",ball:0,actions:[],category:i.value}}}),{showing:f,taskToEdit:t,categoryNames:a,category:i,ball:p,ballNames:r,cancel:()=>{o.emit("cancel")},save:()=>{t.value&&(t.value.category=i.value,t.value.ball=p.value.value),o.emit("ok",t.value)}}}}),ce=c("div",null,null,-1),me={class:"q-ml-sm"};function fe(e,o,r,f,t,g){return d(),b(z,{modelValue:e.showing,"onUpdate:modelValue":o[3]||(o[3]=a=>e.showing=a),persistent:""},{default:l(()=>[u(F,{style:{width:"300px"}},{default:l(()=>[u(D,{class:"row items-center"},{default:l(()=>[ce]),_:1}),u(D,{class:"q-mr-md"},{default:l(()=>[c("div",null,[c("div",me,[u(G,{class:"q-mb-md",outlined:"",autofocus:"",modelValue:e.taskToEdit.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.taskToEdit.name=a),label:"\u0418\u043C\u044F \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B"},null,8,["modelValue"]),u(V,{class:"full-width q-mb-md",outlined:"",modelValue:e.category,"onUpdate:modelValue":o[1]||(o[1]=a=>e.category=a),options:e.categoryNames,label:"\u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F"},null,8,["modelValue","options"]),u(V,{class:"full-width",outlined:"",modelValue:e.ball,"onUpdate:modelValue":o[2]||(o[2]=a=>e.ball=a),options:e.ballNames,label:"\u041F\u043E\u0437\u0438\u0446\u0438\u044F \u0448\u0430\u0440\u0430"},null,8,["modelValue","options"])])])]),_:1}),u(U,{align:"right"},{default:l(()=>[u(v,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"primary",onClick:e.cancel},null,8,["onClick"]),u(v,{flat:"",label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",color:"primary",onClick:e.save},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var pe=T(de,[["render",fe]]);const ve=B({name:"StationGet",props:{isShow:{type:Boolean,default:!1}},components:{},setup(e,o){const r=A(()=>e.isShow),f=ie(),{workstations:t}=$(f);return L(()=>r.value,i=>{}),{showing:r,workstations:t,cancel:()=>{o.emit("cancel")},choice:i=>{o.emit("ok",i)}}}}),ge=e=>(O("data-v-3455786f"),e=e(),j(),e),Ce=ge(()=>c("div",null,"\u0412\u044B\u0431\u043E\u0440 \u0441\u0442\u0430\u043D\u0446\u0438\u0438",-1)),ke={key:0,class:"q-ml-sm"};function we(e,o,r,f,t,g){return d(),b(z,{modelValue:e.showing,"onUpdate:modelValue":o[0]||(o[0]=a=>e.showing=a),persistent:""},{default:l(()=>[u(F,{style:{width:"300px"}},{default:l(()=>[u(D,{class:"row items-center"},{default:l(()=>[Ce]),_:1}),u(D,{class:"q-mr-md"},{default:l(()=>[c("div",null,[e.workstations.length===0?(d(),w("div",ke," \u041D\u0435\u0442 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044B\u0445 \u0441\u0442\u0430\u043D\u0446\u0438\u0439 ")):(d(),b(F,{key:1},{default:l(()=>[(d(!0),w(I,null,ue(e.workstations,a=>(d(),b(D,{class:"flex justify-between items-center",key:a.name},{default:l(()=>[c("div",null,oe(a.name),1),u(v,{class:"q-mr-sm item-control",size:"12px",flat:"",dense:"",round:"",icon:`arrow_circle_right
`,onClick:i=>e.choice(a)},{default:l(()=>[u(h,null,{default:l(()=>[_("\u0412\u044B\u0431\u0440\u0430\u0442\u044C")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}))])]),_:1}),u(U,{align:"right"},{default:l(()=>[u(v,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"primary",onClick:e.cancel},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var ye=T(ve,[["render",we],["__scopeId","data-v-3455786f"]]);const he=e=>e===0?"\u043B\u0435\u0432\u044B\u0439":"\u043F\u0440\u0430\u0432\u044B\u0439",_e=[{name:"name",required:!0,label:"\u0418\u043C\u044F \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!1},{name:"category",required:!0,label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",align:"left",field:e=>e.category,format:e=>`${e}`,sortable:!1},{name:"ball",required:!0,label:"\u0428\u0430\u0440",align:"left",field:e=>he(e.ball),format:e=>`${e}`,sortable:!1},{name:"id",required:!0,label:"\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435",align:"right",field:e=>e.id,format:e=>`${e}`,sortable:!1}],Ee=B({name:"ProgramsList",components:{ProgramEdit:pe,ConfirmDialog:le,StationGet:ye,LoadingComponent:re},setup(){const e=ne(),o=M(),{tasks:r,loading:f}=$(e),t=m(""),g=ae(),a=m(!1),i=m(!1),p=m(!1),k=m(null),s=m(null),C=m(0),{categoryNames:y}=$(o),q=m(""),Q=async()=>{await o.getCategories(),await e.getTasks();const n=o.getDefaultCategory();q.value=n?n.name:""},R=n=>{C.value=n,i.value=!0},H=async()=>{await e.delete(C.value),N()},N=()=>{C.value=0,i.value=!1},K=n=>{g.push({path:"program-actions",query:{id:n.id,type:"server"}})},W=n=>{s.value=n,p.value=!0},J=n=>{k.value=n,a.value=!0},X=()=>{k.value=null,a.value=!0},Y=async n=>{n.name!==""&&(k.value?await e.update(n):await e.insert(n)),a.value=!1},Z=()=>{k.value=null,a.value=!1},P=()=>{p.value=!1},x=n=>{const ee=s.value;e.moveToStation(n,ee),s.value=null,P()};return Q(),{tasks:r,columns:_e,searchByName:t,loading:f,isEditShow:a,isShowDeleteDialog:i,isShowGetDialog:p,editTask:k,categoryNames:y,category:q,refreshTasks:Q,confirmDelete:R,confirmMoveToStation:W,showActions:K,showEdit:J,addTask:X,closeEdit:Z,saveTask:Y,deleteTask:H,closeDeleteDialog:N,closeMove:P,moveTaskToStation:x}}}),be=e=>(O("data-v-5f438c44"),e=e(),j(),e),De={key:1,class:"flex justify-evenly full-width q-pa-md"},Se=be(()=>c("div",{class:"text-h6 full-width q-ma-md"},"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435",-1)),$e={key:0,class:"full-width"},Be={class:"row justify-end"},Te={class:"flex justify-end item-control"},Ve={class:"q-gutter-xs"},Fe={class:"flex"},qe={key:1};function Qe(e,o,r,f,t,g){const a=E("LoadingComponent"),i=E("ProgramEdit"),p=E("ConfirmDialog"),k=E("StationGet");return d(),w(I,null,[e.loading?(d(),b(a,{key:0})):(d(),w("section",De,[Se,e.loading?(d(),w("div",qe,"Loading")):(d(),w("div",$e,[u(se,{flat:"",bordered:"","virtual-scroll":"",rows:e.tasks(e.searchByName,e.category),columns:e.columns,"row-key":"name","rows-per-page-options":[15,20,25,50,0]},{"body-cell-id":l(s=>[u(te,{props:s},{default:l(()=>[c("div",Be,[c("div",Te,[c("div",Ve,[u(v,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"edit",onClickCapture:S(C=>e.showEdit(s.row),["stop"])},{default:l(()=>[u(h,null,{default:l(()=>[_("\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C")]),_:1})]),_:2},1032,["onClickCapture"]),u(v,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"login",onClickCapture:S(C=>e.showActions(s.row),["stop"])},{default:l(()=>[u(h,null,{default:l(()=>[_("\u0421\u043F\u0438\u0441\u043E\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439")]),_:1})]),_:2},1032,["onClickCapture"]),u(v,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"download",onClickCapture:S(C=>e.confirmMoveToStation(s.row),["stop"])},{default:l(()=>[u(h,null,{default:l(()=>[_("\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u044C \u043D\u0430 \u0441\u0442\u0430\u043D\u0446\u0438\u044E")]),_:1})]),_:2},1032,["onClickCapture"]),u(v,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClickCapture:S(C=>e.confirmDelete(s.row.id),["stop"])},{default:l(()=>[u(h,null,{default:l(()=>[_("\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435")]),_:1})]),_:2},1032,["onClickCapture"])])])])]),_:2},1032,["props"])]),"top-left":l(()=>[c("div",Fe,[u(G,{class:"q-mb-md",debounce:"300",outlined:"",modelValue:e.searchByName,"onUpdate:modelValue":o[0]||(o[0]=s=>e.searchByName=s),label:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u0438\u043C\u0435\u043D\u0438"},null,8,["modelValue"]),u(V,{class:"full-width",outlined:"",modelValue:e.category,"onUpdate:modelValue":o[1]||(o[1]=s=>e.category=s),options:e.categoryNames,label:"\u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F"},null,8,["modelValue","options"])])]),"top-right":l(()=>[c("div",null,[u(v,{outline:"",color:"primary",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",onClick:o[2]||(o[2]=s=>e.addTask()),class:"q-mr-xs"}),u(v,{outline:"",color:"primary",label:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",onClick:o[3]||(o[3]=s=>e.refreshTasks())})])]),_:1},8,["rows","columns"])]))])),u(i,{isShow:e.isEditShow,task:e.editTask,onCancel:e.closeEdit,onOk:e.saveTask},null,8,["isShow","task","onCancel","onOk"]),u(p,{isShow:e.isShowDeleteDialog,message:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u0443\u044E \u0437\u0430\u043F\u0438\u0441\u044C \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435?",onOk:e.deleteTask,onCancel:e.closeDeleteDialog},null,8,["isShow","onOk","onCancel"]),u(k,{isShow:e.isShowGetDialog,onCancel:e.closeMove,onOk:e.moveTaskToStation},null,8,["isShow","onCancel","onOk"])],64)}var Ne=T(Ee,[["render",Qe],["__scopeId","data-v-5f438c44"]]);const Pe=B({name:"ProgramsPage",components:{ProgramsList:Ne},setup(){return{}}}),Ae={class:"flex justify-evenly"};function Le(e,o,r,f,t,g){const a=E("ProgramsList");return d(),w("section",Ae,[u(a)])}var ou=T(Pe,[["render",Le]]);export{ou as default};
