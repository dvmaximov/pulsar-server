import{Q as P,a as w}from"./QSelect.64399ad0.js";import{A as $,ai as A,r as f,K as S,w as N,_ as T,C as v,D,E as t,F as u,af as i,L as p,M as k,N as ue,O as I,I as oe,H as y,ay as L,az as O,ae,B as E,aj as _}from"./index.80abe7d4.js";import{C as te,Q as se,a as le}from"./ConfirmDialog.a100e7fd.js";import{Q as j}from"./QInput.3ab979f5.js";import{u as ne}from"./programs.store.72721274.js";import{a as h,Q as B}from"./QCard.19bfa731.js";import{Q as G}from"./QCardActions.d7f59fa3.js";import{Q as z}from"./QDialog.bbc8dda5.js";import{u as M}from"./categories.store.86b52134.js";import{a as ie}from"./socket.store.1ac043d9.js";import"./use-timeout.488bde93.js";import"./QItem.ad7da8b2.js";import"./use-dark.f766abe3.js";import"./QSeparator.39e6f7a2.js";import"./QList.cdb5ec21.js";import"./message.store.e621899a.js";import"./use-quasar.1e946b26.js";const re=$({name:"ProgramEdit",props:{isShow:{type:Boolean,default:!1},task:{type:Object}},components:{},setup(e,o){const r=A(()=>e.isShow),l=f(),d=M(),{categoryNames:g}=S(d),a=f("");return N(()=>r.value,s=>{if(s)if(e.task)l.value={...e.task},a.value=l.value.category?l.value.category:"";else{const m=d.getDefaultCategory();a.value=m?m.name:"\u0431\u0435\u0437 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u0438",l.value={name:"\u043D\u0435 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043E",description:"",actions:[],category:a.value}}}),{showing:r,taskToEdit:l,categoryNames:g,category:a,cancel:()=>{o.emit("cancel")},save:()=>{l.value&&(l.value.category=a.value),o.emit("ok",l.value)}}}}),de=i("div",null,null,-1),ce={class:"q-ml-sm"};function me(e,o,r,l,d,g){return v(),D(z,{modelValue:e.showing,"onUpdate:modelValue":o[2]||(o[2]=a=>e.showing=a),persistent:""},{default:t(()=>[u(B,{style:{width:"300px"}},{default:t(()=>[u(h,{class:"row items-center"},{default:t(()=>[de]),_:1}),u(h,{class:"q-mr-md"},{default:t(()=>[i("div",null,[i("div",ce,[u(j,{class:"q-mb-md",outlined:"",autofocus:"",modelValue:e.taskToEdit.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.taskToEdit.name=a),label:"\u0418\u043C\u044F \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B"},null,8,["modelValue"]),u(P,{class:"full-width",outlined:"",modelValue:e.category,"onUpdate:modelValue":o[1]||(o[1]=a=>e.category=a),options:e.categoryNames,label:"\u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F"},null,8,["modelValue","options"])])])]),_:1}),u(G,{align:"right"},{default:t(()=>[u(p,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"primary",onClick:e.cancel},null,8,["onClick"]),u(p,{flat:"",label:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",color:"primary",onClick:e.save},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var fe=T(re,[["render",me]]);const pe=$({name:"StationGet",props:{isShow:{type:Boolean,default:!1}},components:{},setup(e,o){const r=A(()=>e.isShow),l=ie(),{workstations:d}=S(l);return N(()=>r.value,c=>{}),{showing:r,workstations:d,cancel:()=>{o.emit("cancel")},choice:c=>{o.emit("ok",c)}}}}),ve=e=>(L("data-v-3455786f"),e=e(),O(),e),ge=ve(()=>i("div",null,"\u0412\u044B\u0431\u043E\u0440 \u0441\u0442\u0430\u043D\u0446\u0438\u0438",-1)),Ce={key:0,class:"q-ml-sm"};function ke(e,o,r,l,d,g){return v(),D(z,{modelValue:e.showing,"onUpdate:modelValue":o[0]||(o[0]=a=>e.showing=a),persistent:""},{default:t(()=>[u(B,{style:{width:"300px"}},{default:t(()=>[u(h,{class:"row items-center"},{default:t(()=>[ge]),_:1}),u(h,{class:"q-mr-md"},{default:t(()=>[i("div",null,[e.workstations.length===0?(v(),k("div",Ce," \u041D\u0435\u0442 \u043F\u043E\u0434\u043A\u043B\u044E\u0447\u0435\u043D\u043D\u044B\u0445 \u0441\u0442\u0430\u043D\u0446\u0438\u0439 ")):(v(),D(B,{key:1},{default:t(()=>[(v(!0),k(I,null,ue(e.workstations,a=>(v(),D(h,{class:"flex justify-between items-center",key:a.name},{default:t(()=>[i("div",null,oe(a.name),1),u(p,{class:"q-mr-sm item-control",size:"12px",flat:"",dense:"",round:"",icon:`arrow_circle_right
`,onClick:c=>e.choice(a)},{default:t(()=>[u(w,null,{default:t(()=>[y("\u0412\u044B\u0431\u0440\u0430\u0442\u044C")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024))),128))]),_:1}))])]),_:1}),u(G,{align:"right"},{default:t(()=>[u(p,{flat:"",label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"primary",onClick:e.cancel},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}var we=T(pe,[["render",ke],["__scopeId","data-v-3455786f"]]);const ye=[{name:"name",required:!0,label:"\u0418\u043C\u044F \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B",align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!1},{name:"category",required:!0,label:"\u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F",align:"left",field:e=>e.category,format:e=>`${e}`,sortable:!1},{name:"id",required:!0,label:"\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435",align:"right",field:e=>e.id,format:e=>`${e}`,sortable:!1}],he=$({name:"ProgramsList",components:{ProgramEdit:fe,ConfirmDialog:te,StationGet:we},setup(){const e=ne(),o=M(),{tasks:r,loading:l}=S(e),d=f(""),g=ae(),a=f(!1),c=f(!1),C=f(!1),s=f(null),m=f(null),b=f(0),{categoryNames:U}=S(o),V=f(""),q=async()=>{await e.getTasks(),await o.getCategories();const n=o.getDefaultCategory();V.value=n?n.name:""},R=n=>{b.value=n,c.value=!0},H=async()=>{await e.delete(b.value),F()},F=()=>{b.value=0,c.value=!1},K=n=>{g.push({path:"program-actions",query:{id:n.id,type:"server"}})},W=n=>{m.value=n,C.value=!0},J=n=>{s.value=n,a.value=!0},X=()=>{s.value=null,a.value=!0},Y=async n=>{n.name!==""&&(s.value?await e.update(n):await e.insert(n)),a.value=!1},Z=()=>{s.value=null,a.value=!1},Q=()=>{C.value=!1},x=n=>{const ee=m.value;e.moveToStation(n,ee),m.value=null,Q()};return q(),{tasks:r,columns:ye,searchByName:d,loading:l,isEditShow:a,isShowDeleteDialog:c,isShowGetDialog:C,editTask:s,categoryNames:U,category:V,refreshTasks:q,confirmDelete:R,confirmMoveToStation:W,showActions:K,showEdit:J,addTask:X,closeEdit:Z,saveTask:Y,deleteTask:H,closeDeleteDialog:F,closeMove:Q,moveTaskToStation:x}}}),_e=e=>(L("data-v-576940c8"),e=e(),O(),e),De={class:"flex justify-evenly full-width q-pa-md"},Ee=_e(()=>i("div",{class:"text-h6 full-width q-ma-md"},"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435",-1)),Se={key:0,class:"full-width"},$e={class:"row justify-end"},Te={class:"flex justify-end item-control"},be={class:"q-gutter-xs"},Be={class:"flex"},Ve={key:1};function qe(e,o,r,l,d,g){const a=E("ProgramEdit"),c=E("ConfirmDialog"),C=E("StationGet");return v(),k(I,null,[i("section",De,[Ee,e.loading?(v(),k("div",Ve,"Loading")):(v(),k("div",Se,[u(le,{flat:"",bordered:"","virtual-scroll":"",rows:e.tasks(e.searchByName,e.category),columns:e.columns,"row-key":"name","rows-per-page-options":[15,20,25,50,0]},{"body-cell-id":t(s=>[u(se,{props:s},{default:t(()=>[i("div",$e,[i("div",Te,[i("div",be,[u(p,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"edit",onClickCapture:_(m=>e.showEdit(s.row),["stop"])},{default:t(()=>[u(w,null,{default:t(()=>[y("\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u0442\u044C")]),_:1})]),_:2},1032,["onClickCapture"]),u(p,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"login",onClickCapture:_(m=>e.showActions(s.row),["stop"])},{default:t(()=>[u(w,null,{default:t(()=>[y("\u0421\u043F\u0438\u0441\u043E\u043A \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439")]),_:1})]),_:2},1032,["onClickCapture"]),u(p,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"download",onClickCapture:_(m=>e.confirmMoveToStation(s.row),["stop"])},{default:t(()=>[u(w,null,{default:t(()=>[y("\u041F\u0435\u0440\u0435\u0434\u0430\u0442\u044C \u043D\u0430 \u0441\u0442\u0430\u043D\u0446\u0438\u044E")]),_:1})]),_:2},1032,["onClickCapture"]),u(p,{class:"q-mr-sm",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClickCapture:_(m=>e.confirmDelete(s.row.id),["stop"])},{default:t(()=>[u(w,null,{default:t(()=>[y("\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435")]),_:1})]),_:2},1032,["onClickCapture"])])])])]),_:2},1032,["props"])]),"top-left":t(()=>[i("div",Be,[u(j,{class:"q-mb-md",debounce:"300",outlined:"",modelValue:e.searchByName,"onUpdate:modelValue":o[0]||(o[0]=s=>e.searchByName=s),label:"\u041F\u043E\u0438\u0441\u043A \u043F\u043E \u0438\u043C\u0435\u043D\u0438"},null,8,["modelValue"]),u(P,{class:"full-width",outlined:"",modelValue:e.category,"onUpdate:modelValue":o[1]||(o[1]=s=>e.category=s),options:e.categoryNames,label:"\u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F"},null,8,["modelValue","options"])])]),"top-right":t(()=>[i("div",null,[u(p,{outline:"",color:"primary",label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",onClick:o[2]||(o[2]=s=>e.addTask()),class:"q-mr-xs"}),u(p,{outline:"",color:"primary",label:"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C",onClick:o[3]||(o[3]=s=>e.refreshTasks())})])]),_:1},8,["rows","columns"])]))]),u(a,{isShow:e.isEditShow,task:e.editTask,onCancel:e.closeEdit,onOk:e.saveTask},null,8,["isShow","task","onCancel","onOk"]),u(c,{isShow:e.isShowDeleteDialog,message:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u0443\u044E \u0437\u0430\u043F\u0438\u0441\u044C \u043D\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435?",onOk:e.deleteTask,onCancel:e.closeDeleteDialog},null,8,["isShow","onOk","onCancel"]),u(C,{isShow:e.isShowGetDialog,onCancel:e.closeMove,onOk:e.moveTaskToStation},null,8,["isShow","onCancel","onOk"])],64)}var Fe=T(he,[["render",qe],["__scopeId","data-v-576940c8"]]);const Qe=$({name:"ProgramsPage",components:{ProgramsList:Fe},setup(){return{}}}),Pe={class:"flex justify-evenly"};function Ae(e,o,r,l,d,g){const a=E("ProgramsList");return v(),k("section",Pe,[u(a)])}var xe=T(Qe,[["render",Ae]]);export{xe as default};
